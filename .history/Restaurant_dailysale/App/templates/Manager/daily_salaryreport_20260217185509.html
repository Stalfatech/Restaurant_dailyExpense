{% extends "base.html" %}
{% load static %}
{% block 'content' %}

<!-- Bootstrap 5 CDN (If not already in base.html) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="container-fluid mt-5">

    <!-- Header -->
    <div class="text-center mb-4">
        <h2 class="fw-bold">Daily Salary Report</h2>
        <p class="text-muted mb-0">
            Date: {{ selected_date|default:today_date }}
        </p>
    </div>

  
     <div class="row justify-content-center mb-4 g-3">
    <!-- Total Paid Salary Card -->
    <div class="col-md-4">
        <div class="card shadow text-center border-0" style="background:#0d6efd; color:white; border-radius:12px;">
            <div class="card-body py-4">
                <h5 class="fw-semibold">Total Paid Salary</h5>
                <h2 class="fw-bold mt-2"> {{ total_paid }}</h2>
            </div>
        </div>
    </div>

    <!-- Total Advance Card -->
    <div class="col-md-4">
        <div class="card shadow text-center border-0" style="background:#0d6efd; color:white; border-radius:12px;">
            <div class="card-body py-4">
                <h5 class="fw-semibold">Total Advance</h5>
                <h2 class="fw-bold mt-2"> {{ total_advance }}</h2>
            </div>
        </div>
    </div>
      <!-- Filter Section -->
    <form method="get" class="mb-4 no-print">
        <div class="row g-3 justify-content-center align-items-end">

            <div class="col-md-3">
                <label class="form-label fw-semibold">Staff Name</label>
                <input type="text"
                       name="staff"
                       value="{{ staff_name }}"
                       class="form-control"
                       placeholder="Enter staff name">
            </div>

            <div class="col-md-3">
                <label class="form-label fw-semibold">Select Date</label>
                <input type="date"
                       name="date"
                       value="{{ selected_date|default:today_date }}"
                       class="form-control">
            </div>

            <div class="col-md-3 d-flex gap-2">
                <button type="submit" class="btn btn-primary mt-4 w-50">
                    Filter
                </button>
                <a href="{% url 'daily_salary_report' %}"
                   class="btn btn-secondary mt-4 w-50">
                    Clear
                </a>
            </div>

        </div>
    </form>
</div>



    <!-- Salary Table -->
    <div class="card shadow">
        <div class="card-body p-0">

            <table class="table table-bordered mb-0 text-center">

                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>Staff</th>
                        <th>Branch</th>
                        <th>Total Salary</th>
                        <th>Advance</th>
                        <th>Paid</th>
                        <th>Balance</th>
                        <th>Payment Mode</th>
                        <th>Payment Date</th>
                    </tr>
                </thead>

                <tbody>
                    {% for salary in salaries %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td class="text-start">{{ salary.staff.name }}</td>
                        <td>{{ salary.branch.name }}</td>
                        <td> {{ salary.salary_amount }}</td>
                        <td> {{ salary.adjusted_advance }}</td>
                        <td> {{ salary.paid_amount }}</td>
                        <td>
                            {% if salary.balance_salary > 0 %}
                                {{ salary.balance_salary }}
                            {% else %}
                                <span class="badge bg-success">Cleared</span>
                            {% endif %}
                        </td>
                        <td>{{ salary.payment_mode }}</td>
                        <td>{{ salary.payment_date }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="9" class="py-3">
                            No salary records found.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>

        </div>
    </div>

    <!-- Print Button -->
    <div class="text-end mt-3 no-print">
        <button onclick="window.print()" class="btn btn-success">
            Print Report
        </button>
    </div>

</div>

<!-- Custom CSS -->
<style>

/* Prevent word breaking */
th, td {
    white-space: nowrap;
    padding: 12px 20px !important;
    font-size: 15px;
}

/* Remove horizontal scroll */
body {
    overflow-x: hidden;
}

/* PRINT SETTINGS */
@media print {

    @page {
        size: A4 landscape;
        margin: 12mm;
    }

    .no-print {
        display: none !important;
    }

    body {
        background: white !important;
    }

    table {
        width: 100% !important;
        font-size: 14px;
    }

    th, td {
        white-space: nowrap;
        padding: 14px 24px !important;
    }

    .card {
        border: none !important;
        box-shadow: none !important;
    }

}

</style>

{% endblock %}