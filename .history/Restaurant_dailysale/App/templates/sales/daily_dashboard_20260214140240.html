{% extends "base.html" %}
{% block 'content' %}

<h3>Daily Sales Dashboard</h3>

<!-- Date Filter -->
<form method="GET" class="row mb-3">
    <div class="col-md-3">
        <input type="date" name="date" value="{{ selected_date|date:'Y-m-d' }}" class="form-control">
    </div>
    <div class="col-md-2">
        <button type="submit" class="btn btn-secondary">Filter</button>
    </div>
</form>

<a href="{% url 'add_daily_sale' %}" class="btn btn-primary mb-3">
    + Add Daily Sale
</a>

<table class="table table-bordered table-striped">
    <thead class="table-dark">
        <tr>
            {% if request.user.user_type == 0 %}
                <th>Branch</th>
            {% endif %}
            <th>Date<
            <th>Breakfast</th>
            <th>Lunch</th>
            <th>Dinner</th>
            <th>Delivery</th>
            <th>POS</th>
            <th>Total</th>
            <th>Cash</th>
        </tr>
    </thead>
    <tbody>
        {% for sale in sales %}
        <tr>
            {% if request.user.user_type == 0 %}
                <td>{{ sale.branch }}</td>
            {% endif %}
            <td>{{ sale.breakfast|default:0 }}</td>
            <td>{{ sale.lunch|default:0 }}</td>
            <td>{{ sale.dinner|default:0 }}</td>
            <td>{{ sale.delivery|default:0 }}</td>
            <td>{{ sale.pos_amount|default:0 }} ({{ sale.pos_type }})</td>
            <td><strong>{{ sale.total_sales|default:0 }}</strong></td>
            <td><strong>{{ sale.cash_sales|default:0 }}</strong></td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="8" class="text-center text-muted">
                No sales found for selected date.
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<div class="card p-3 shadow-sm">
    <h5>Daily Summary</h5>
    <div class="row">
        <div class="col-md-4">
            <strong>Total Sales:</strong> ₹ {{ totals.total_sales|default:0 }}
        </div>
        <div class="col-md-4">
            <strong>Total Cash:</strong> ₹ {{ totals.total_cash|default:0 }}
        </div>
        <div class="col-md-4">
            <strong>Date:</strong> {{ selected_date }}
        </div>
    </div>
</div>

{% endblock %}
