{% extends "base.html" %}
{% block 'content' %}
  <div class="d-flex justify-content-between align-items-center mb-4  mt-4">
     <h3 class="fw-bold">Daily Sales Dashboard</h3>
        <div class="d-flex gap-2">
    <a href="{% url 'add_daily_sale' %}" class="btn btn-primary">
        + Add Daily Sale
    </a>
     <a href="{% url 'history_sales' %}" class="btn btn-outline-dark">
                <i class="iconoir-clock menu-icon"></i> Sales History
            </a>

           
        </div>
    </div>
{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
{% endif %}

<!-- Date Filter -->
<!-- Date Filter -->
 <div class="row mb-4 justify-content-center">
    <div class="col-md-4">
        <div class="card shadow border-0 bg-success text-white text-center">
            <div class="card-body">
                <p class="text-uppercase mb-1 fw-semibold">Total Sales</p>
                <h3 class="fw-bold">{{totals.total_sales }}</h3>
            </div>
        </div>
    </div>
</div>

<form method="GET" class="row mb-3 align-items-end">
    <div class="col-md-3">
        <label>Select Date</label>
        <input type="date" name="date"
               value="{{ selected_date|date:'Y-m-d' }}"
               class="form-control">
    </div>

    <div class="col-md-2">
        <button type="submit" class="btn btn-secondary w-100">
            Filter
        </button>
    </div>

    <div class="col-md-2">
        <a href="{% url 'daily_sales_dashboard' %}"
           class="btn btn-outline-danger w-100">
            Clear
        </a>
    </div>
</form>




<table class="table table-bordered table-striped">
    <thead class="table-dark">
        <tr>
               <th>Date</th>
       
                <th>Branch</th>
        
         
            <th>Breakfast</th>
            <th>Lunch</th>
            <th>Dinner</th>
            <th>Delivery</th>
            <th>POS</th>
            <th>Total</th>
            <th>Cash</th>
                <th>Action</th> 
        </tr>
    </thead>
    <tbody>
        {% for sale in sales %}
        <tr>
            <td>{{ sale.date|date:"d-m-Y" }}</td>
       
                <td>{{ sale.branch }}</td>
        
            <td>{{ sale.breakfast|default:0 }}</td>
            <td>{{ sale.lunch|default:0 }}</td>
            <td>{{ sale.dinner|default:0 }}</td>
            <td>{{ sale.delivery|default:0 }}</td>
            <td>{{ sale.pos_amount|default:0 }} ({{ sale.pos_type }})</td>
            <td><strong>{{ sale.total_sales|default:0 }}</strong></td>
            <td><strong>{{ sale.cash_sales|default:0 }}</strong></td>
              <td>
                <a href="{% url 'edit_daily_sale' sale.id %}"
                   class="btn btn-sm btn-warning">
                    Edit
                </a>

              <a href="{% url 'delete_daily_sale' sale.id %}"
   class="btn btn-sm btn-danger">
    Delete
</a>

            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="8" class="text-center text-muted">
                No sales found for selected date.
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<div class="card p-3 shadow-sm">
    <h5>Daily Summary</h5>
    <div class="row">
        <div class="col-md-4">
            <strong>Total Sales:</strong> ₹ {{ totals.total_sales|default:0 }}
        </div>
        <div class="col-md-4">
            <strong>Total Cash:</strong> ₹ {{ totals.total_cash|default:0 }}
        </div>
        <div class="col-md-4">
            <strong>Date:</strong> {{ selected_date }}
        </div>
    </div>
</div>

{% endblock %}
